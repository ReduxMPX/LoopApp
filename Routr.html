<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="Routr.css">
    <script src="Routr.js"></script>

    <script src='https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.css' rel='stylesheet' />

    <script
        src="https://cdn.jsdelivr.net/npm/mapbox-gl-animated-popup@v0.3.0/dist/mapbox-gl-animated-popup.min.js"></script>

    <title>Routr</title>
</head>

<body>

    <div id='map'
        style='position:fixed; top:0; left:0; bottom:0; right:0; width:100%; height:100%; border:none; margin:0; padding:0; overflow:hidden; z-index:999999;'>
    </div>
    <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoiYWxla21hcCIsImEiOiJjbDU2MWlnY3kxYzR1M2VzMDViOXoyMXB2In0.XORQ_hEGB0kQEVj5ia_z_A';
        const map = new mapboxgl.Map({
            container: 'map', // container ID
            style: 'mapbox://styles/alekmap/cl562z27v007w15qxxwa1zoj3', // style URL
            center: [-118.46867274389726, 34.07552996200769], // starting position [lng, lat]
            zoom: 9, // starting zoom
            projection: 'globe' // display the map as a 3D globe
        });
        map.on('style.load', () => {
            map.setFog({}); // Set the default atmosphere style
        });
        const nav = new mapboxgl.NavigationControl();
        map.addControl(nav, 'top-right');

        const geojson = {
            type: 'FeatureCollection',
            features: [
                {
                    type: 'Feature',
                    geometry: {
                        type: 'Point',
                        coordinates: [-118.4835772201756, 34.07780998595211]
                    },
                    properties: {
                        title: 'Parked Car',
                        description: '1001 Kenfield Avenue\nLos Angeles, CA\n90049'
                    }
                }
            ]
        };

        for (const feature of geojson.features) {
            // create a HTML element for each feature
            const el = document.createElement('div');
            el.className = 'carmarker';

            // make a marker for each feature and add to the map
            new mapboxgl.Marker(el)
                .setLngLat(feature.geometry.coordinates)
            new mapboxgl.Marker(el)
                .setLngLat(feature.geometry.coordinates)
                .setPopup(
                    new AnimatedPopup({
                        offset: 25, 
                        openingAnimation: {
                            duration: 1000,
                            easing: 'easeOutElastic',
                            transform: 'scale'
                        },
                        closingAnimation: {
                            duration: 300,
                            easing: 'easeInBack',
                            transform: 'scale'
                        }
                    }) // add popups
                        .setHTML(
                            `<h3>${feature.properties.title}</h3><p>${feature.properties.description}</p>`
                        )
                )
                .addTo(map);
        }

    </script>
</body>

</html>